_format_version: "2.1"
_transform: true

###
### Consumers / Users
###
consumers:
    - username: DASHBOARD
    - username: anon
      keyauth_credentials:
          - key: ANON_KEY
    - username: service_role
      keyauth_credentials:
          - key: $SERVICE_KEY

###
### Access Control List
###
acls:
    - consumer: anon
      group: anon
    - consumer: service_role
      group: admin

###
### Dashboard credentials
###
# basicauth_credentials:
#     - consumer: DASHBOARD
#       username: $DASHBOARD_USERNAME
#       password: $DASHBOARD_PASSWORD

services:
    - name: declare-api
      url: http://declare-api:9998
      routes:
          - name: declare-api-route
            strip_path: true
            paths:
                - /api
      plugins:
          - name: cors
          - name: key-auth
            config:
                hide_credentials: true
          - name: acl
            config:
                hide_groups_header: true
                allow:
                    - admin
                    - anon
